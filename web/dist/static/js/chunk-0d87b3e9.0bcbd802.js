(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d87b3e9"],{"3dcf":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{attrs:{"aria-label":"navigation"}},[a("ul",{staticClass:"pagination pagination-sm justify-content-center mb-0"},[a("li",{staticClass:"page-item disabled"},[a("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":"true"}},[t._v("\n                共 "+t._s(t.total)+" 条\n            ")])]),a("li",{staticClass:"page-item",class:{disabled:t.start}},[a("button",{staticClass:"page-link",on:{click:function(e){return t.toPage(1)}}},[t._v("首页")])]),t._l(t.pages,(function(e){return a("li",{staticClass:"page-item",class:{active:e===t.page}},[a("button",{staticClass:"page-link",on:{click:function(a){return t.toPage(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item",class:{disabled:t.end}},[a("button",{staticClass:"page-link",on:{click:function(e){return t.toPage(t.pages.length)}}},[t._v("尾页")])]),a("li",{staticClass:"page-item disabled"},[a("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1","aria-disabled":"true"}},[t._v("\n                每页 "+t._s(t.limit)+" 条\n            ")])])],2)])},i=[],n={name:"XPage",props:{items:Object},methods:{toPage:function(t){this.$emit("change",t)}},computed:{start:function(){return 1===this.page||this.total<this.limit},end:function(){return this.page===this.pages.length||this.total<this.limit},total:function(){return this.items.total},page:function(){return this.items.page},limit:function(){return this.items.limit},pages:function(){for(var t=[],e=1;e<=Math.round(this.total/this.limit);e++)t.push(e);return t}}},r=n,l=a("c701"),c=Object(l["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},"8e4f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-title",{attrs:{title:"负载均衡管理","title-class":"icons cui-puzzle"}},[a("router-link",{staticClass:"btn btn-sm btn-primary",attrs:{to:"/admin/upstream/edit"}},[t._v("\n            添加负载\n        ")])],1),a("div",{staticClass:"p-3"},[a("div",{staticClass:"form-group form-inline"},[a("div",{staticClass:"input-group"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchName,expression:"searchName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"名字"},domProps:{value:t.searchName},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryUpstreams(e)},input:function(e){e.target.composing||(t.searchName=e.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-primary",on:{click:t.queryUpstreams}},[a("i",{staticClass:"fa fa-search-plus"}),t._v(" 搜索\n                    ")])])])]),a("table",{staticClass:"table table-bordered table-hover"},[t._m(1),a("tbody",[t._l(t.upstreams,(function(e,s){return[t.showPage(s)?a("tr",[a("td",[t._v("\n                        "+t._s(e.name)+"\n                        "),""!==e.commit?a("span",{staticClass:"text-black-50"},[a("br"),t._v(t._s(e.commit))]):t._e()]),a("td",[a("span",{staticClass:"badge badge-success"},[t._v(t._s(e.protocol))])]),a("td",[t._v("\n                        "+t._s(""===e.loadStrategy?"默认":e.loadStrategy)+"\n                    ")]),a("td",t._l(e.servers,(function(e,s){return a("span",{staticClass:"font-weight-bold"},[0!==s?a("span",[t._v(",  ")]):t._e(),t._v(" "+t._s(e.host)+":"+t._s(e.port)+"\n                        ")])})),0),a("td",[a("button",{staticClass:"btn btn-sm btn-primary",on:{click:function(a){return t.editUpstream(e)}}},[t._v("\n                            编辑\n                        ")]),a("Delete",{on:{ok:function(a){return t.deleteUpstream(e)}}},[a("button",{staticClass:"btn btn-sm btn-danger ml-2"},[t._v("\n                                删除\n                            ")])])],1)]):t._e()]}))],2),a("tfoot",[a("tr",[a("td",{attrs:{colspan:"5"}},[a("XPage",{attrs:{items:t.page},on:{change:function(e){t.page.page=e}}})],1)])])])])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-prepend"},[a("span",{staticClass:"input-group-text"},[t._v("名字：")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticStyle:{width:"200px"}},[t._v("名称/备注")]),a("th",{staticStyle:{width:"120px"}},[t._v("转发类型")]),a("th",{staticStyle:{width:"120px"}},[t._v("策略")]),a("th",[t._v("负载")]),a("th",{staticStyle:{width:"120px"}},[t._v("操作")])])])}],n=(a("cc57"),a("c0cf")),r=a("c9b1"),l=a("3dcf"),c={name:"Upstreams",components:{XPage:l["a"],Delete:r["a"],VTitle:n["a"]},data:function(){return{upstreams:[],searchName:"",page:{page:1,total:0,limit:12}}},mounted:function(){this.queryUpstreams()},methods:{refresh:function(){this.queryUpstreams()},showPage:function(t){return t>=(this.page.page-1)*this.page.limit&&t<this.page.page*this.page.limit},queryUpstreams:function(){this.startLoading();var t=this,e="/admin/api/upstream";""!==this.searchName&&(e+="?name="+encodeURI(this.searchName)),t.$axios.get(e).then((function(e){t.upstreams=e,t.page.total=t.upstreams.length})).catch((function(e){t.$alert("错误"+e.message)})).finally((function(){t.finishLoading()}))},editUpstream:function(t){this.$router.push({path:"/admin/upstream/edit",query:{name:t.name}})},deleteUpstream:function(t){for(var e=this,a="/admin/api/directive",s=0;s<t.queries.length;s++)a+=0===s?"?q="+encodeURI(t.queries[s]):"&q="+encodeURI(t.queries[s]);this.$axios.delete(a).then((function(t){e.$toast.success("删除成功！"),e.queryUpstreams()})).catch((function(t){e.$toast.error(t.message)}))}}},o=c,u=a("c701"),p=Object(u["a"])(o,s,i,!1,null,null,null);e["default"]=p.exports},c0cf:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ol",{staticClass:"breadcrumb breadcrumb-fixed"},[a("li",{staticClass:"breadcrumb-item"},[a("i",{staticClass:"fa",class:t.titleClass}),t._v(" "+t._s(t.title)+"\n    ")]),a("li",{staticClass:"ml-auto"},[t._t("default")],2)])},i=[],n={name:"vTitle",props:{title:String,titleClass:{type:String,default:""}}},r=n,l=a("c701"),c=Object(l["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},c9b1:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{on:{click:t.confirm}},[t._t("default")],2)},i=[],n={name:"delete",props:{title:{type:String,default:"确定？"},message:{type:String,default:"确定删除"}},methods:{confirm:function(){var t=this;this.$confirm(t.message,{title:t.title}).then((function(e){t.$emit("ok")})).catch((function(t){}))}}},r=n,l=a("c701"),c=Object(l["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-0d87b3e9.0bcbd802.js.map