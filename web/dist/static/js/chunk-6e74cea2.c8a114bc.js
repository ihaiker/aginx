(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e74cea2"],{"0e63":function(t,e,s){},"4ba2":function(t,e,s){var a=s("2ea2"),r=s("2f77"),n=s("69b3"),i=s("e7ad").Reflect;t.exports=i&&i.ownKeys||function(t){var e=a.f(n(t)),s=r.f;return s?e.concat(s(t)):e}},"5ab2":function(t,e,s){var a=s("e46b"),r=s("4ba2"),n=s("09b9"),i=s("dcb7"),o=s("ebc3");a(a.S,"Object",{getOwnPropertyDescriptors:function(t){var e,s,a=n(t),c=i.f,l=r(a),u={},p=0;while(l.length>p)s=c(a,e=l[p++]),void 0!==s&&o(u,e,s);return u}})},"5df5":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:t.transition,appear:""}},[t.show?s("div",{ref:"modal",staticClass:"modal fade show",style:t.getStyle,on:{mousedown:t.mouseDown}},[s("div",{staticClass:"modal-dialog",class:t.getClass,attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._t("modal-header",[t.title?s("div",{staticClass:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v(t._s(t.title))]),s("a",{staticClass:"close",attrs:{"aria-label":"Close"},on:{click:function(e){return e.stopPropagation(),t.clickCloseBtn(e)}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]):t._e()]),s("div",{staticClass:"modal-body p-0"},[t._t("default")],2),t._t("modal-footer",[s("div",{staticClass:"modal-footer"},[t.cancelButtonOptions.visible?s("button",{staticClass:"w-25",class:Object.assign({},t.cancelButtonOptions.btnClass),attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return e.stopPropagation(),t.clickCloseBtn(e)}}},[t._v(t._s(t.cancelButtonOptions.title)+"\n                        ")]):t._e(),t.saveButtonOptions.visible?s("button",{staticClass:"w-25",class:Object.assign({},t.saveButtonOptions.btnClass),attrs:{type:"button"},on:{click:t.clickSaveBtn}},[t._v(t._s(t.saveButtonOptions.title)+"\n                        ")]):t._e()])])],2)])]):t._e()])},r=[];s("5ab2"),s("6d57"),s("e10e");function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function i(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function o(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var c={count:0},l={name:"modal",props:{show:Boolean,title:String,modalClass:{type:Object,default:null},hasBackdrop:{type:Boolean,default:!0},saveButton:{type:Object,default:function(){return{}}},cancelButton:{type:Object,default:function(){return{}}},transition:{type:String,default:"translate-fade"},closeOnEscape:{type:Boolean,default:!0}},data:function(){return{isShow:this.show,backdrop:null,zIndex:0,modals:c}},mounted:function(){this.show&&(c.count++,this.zIndex=c.count,this.$emit("show",!0,this.zIndex,c.count)),this.checkBackdrop()},destroyed:function(){this.show&&(c.count--,this.zIndex=c.count,this.$emit("show",!1,this.zIndex,c.count)),this.backdrop&&this.show&&document.body.removeChild(this.backdrop),0===c.count&&document.body.classList.remove("modal-open")},methods:{clickCloseBtn:function(){this.$emit("cancel")},clickSaveBtn:function(){this.$emit("ok")},handleEscape:function(t){this.show&&27===t.keyCode&&this.zIndex===this.totalModals&&this.$emit("close")},mouseDown:function(t){this.$refs.modal===t.target&&(this.$emit("close"),t.preventDefault())},checkBackdrop:function(){this.hasBackdrop&&(this.show&&1===this.zIndex?document.body.classList.add("modal-open"):!this.show&&(this.zIndex,this.totalModals),this.show?(this.backdrop=document.createElement("div"),this.backdrop.classList.add("modal-backdrop","fade","show"),this.backdrop.style.zIndex=1048+2*this.zIndex,document.body.appendChild(this.backdrop)):this.backdrop&&(document.body.removeChild(this.backdrop),document.body.classList.remove("modal-open")))}},computed:{totalModals:function(){return c.count},getStyle:function(){var t={};return this.show&&(t.display="block"),t["z-index"]=1048+2*this.zIndex+1,t},getClass:function(){var t={},e=this.totalModals-this.zIndex;return t["modal-stack-"+e]=!0,t["modal-order-"+this.zIndex]=!0,t.aside=this.zIndex!==this.totalModals,o(o({},t),this.modalClass)},saveButtonOptions:function(){var t={title:"确定",visible:!0,btnClass:{"btn btn-primary":!0}};return o(o({},t),this.saveButton)},cancelButtonOptions:function(){var t={title:"取消",visible:!0,btnClass:{"btn btn-outline-secondary":!0}};return o(o({},t),this.cancelButton)}},watch:{show:function(t){t?c.count++:c.count--,this.zIndex=c.count,this.$emit("show",t,this.zIndex,c.count),t||0!==c.count||document.body.classList.remove("modal-open"),this.checkBackdrop()},closeOnEscape:{handler:function(t){"undefined"!==typeof document&&(t?document.addEventListener("keydown",this.handleEscape):document.removeEventListener("keydown",this.handleEscape))},immediate:!0}}},u=l,p=(s("cbb6"),s("c701")),d=Object(p["a"])(u,a,r,!1,null,"0d2e2f80",null);e["a"]=d.exports},"6d20":function(t,e,s){"use strict";s("d61f")},cbb6:function(t,e,s){"use strict";s("0e63")},d61f:function(t,e,s){},e10e:function(t,e,s){var a=s("008a"),r=s("80a9");s("f0cc")("keys",(function(){return function(t){return r(a(t))}}))},e496:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-title",{attrs:{title:"编辑服务","title-class":"icons cui-puzzle"}},[t.server.queries&&t.server.queries.length>0?[t._v("\n            搜索路径："),t._l(t.server.queries,(function(e){return s("span",{staticClass:"badge badge-dark ml-1"},[t._v(t._s(e))])}))]:t._e()],2),s("div",{staticClass:"p-3"},[s("ServerListens",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}),"http"===t.server.protocol?s("ServerName",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}):t._e(),s("div",{staticClass:"form-group"},[s("div",{staticClass:"input-group"},[t._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.commit,expression:"server.commit"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.server.commit},on:{input:function(e){e.target.composing||t.$set(t.server,"commit",e.target.value)}}}),void 0===t.$route.query.name||"http"!==t.server.protocol?[t._m(1),s("select",{directives:[{name:"model",rawName:"v-model",value:t.server.protocol,expression:"server.protocol"}],staticClass:"form-control",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.server,"protocol",e.target.multiple?s:s[0])},function(e){return t.setServerProtocol(e.target.value)}]}},[void 0===t.$route.query.name?s("option",{attrs:{value:"http"}},[t._v("HTTP\n                        ")]):t._e(),s("option",{attrs:{value:"tcp"}},[t._v("TCP")]),s("option",{attrs:{value:"udp"}},[t._v("UDP")])])]:t._e()],2)]),"http"===t.server.protocol?s("ServerSSL",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}):t._e(),s("ServerLocations",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}),s("HideCard",{attrs:{title:"额外参数"}},[s("Partamters",{attrs:{prompt:"server"},model:{value:t.server.parameters,callback:function(e){t.$set(t.server,"parameters",e)},expression:"server.parameters"}}),s("hr"),"http"===t.server.protocol?s("BasicAuth",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}):t._e(),"http"===t.server.protocol?s("RewriteMobile",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}}):t._e(),s("AllowDeny",{model:{value:t.server,callback:function(e){t.server=e},expression:"server"}})],1),s("div",{staticClass:"d-flex justify-content-center"},[s("button",{staticClass:"btn btn-css3",on:{click:t.modfiyServer}},[t._v("\n                确定更新\n            ")]),s("router-link",{staticClass:"btn btn-default ml-3",attrs:{to:"/admin/servers"},on:{click:function(t){}}},[t._v("\n                取　　消\n            ")])],1)],1)],1)},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("备注")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("转发类型")])])}],n=(s("cc57"),s("c0cf")),i=s("8a2b"),o=(s("5f12"),s("cc69"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"form-group"},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:t.switchSupport}},[t._v("\n                    开始自动转向手机端:\n                    "),s("i",{staticClass:"fa",class:t.support?"fa-check-circle text-success":"fa-square-o"})])]),t._m(0),t.support?[t._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.rewriteMobile.domain,expression:"server.rewriteMobile.domain"}],staticClass:"form-control",attrs:{placeholder:"转向地址",type:"text"},domProps:{value:t.server.rewriteMobile.domain},on:{input:function(e){e.target.composing||t.$set(t.server.rewriteMobile,"domain",e.target.value)}}})]:t._e()],2)]),t.support?s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-col-form-label",attrs:{for:"inputSuccess1"}},[t._v("手机端匹配agents")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.server.rewriteMobile.agents,expression:"server.rewriteMobile.agents"}],staticClass:"form-control is-valid",staticStyle:{height:"140px"},domProps:{value:t.server.rewriteMobile.agents},on:{input:function(e){e.target.composing||t.$set(t.server.rewriteMobile,"agents",e.target.value)}}})]):t._e()])}),c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-append"},[s("div",{staticClass:"input-group-text"},[t._v("\n                    开启后手机访问网页将自动转向手机网页\n                ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text btn-default"},[t._v("转向地址：")])])}],l={name:"RewriteMobile",model:{prop:"server",event:"change"},props:["server"],computed:{support:function(){return void 0!==this.server.rewriteMobile}},methods:{switchSupport:function(){this.support?this.$delete(this.server,"rewriteMobile"):this.$set(this.server,"rewriteMobile",{agents:'"(MIDP)|(WAP)|(UP.Browser)|(Smartphone)|(Obigo)|(Mobile)|(AU.Browser)|(wxd.Mms)|(WxdB.Browser)|(CLDC)|(UP.Link)|(KM.Browser)|(UCWEB)|(SEMC-Browser)|(Mini)|(Symbian)|(Palm)|(Nokia)|(Panasonic)|(MOT-)|(SonyEricsson)|(NEC-)|(Alcatel)|(Ericsson)|(BENQ)|(BenQ)|(Amoisonic)|(Amoi-)|(Capitel)|(PHILIPS)|(SAMSUNG)|(Lenovo)|(Mitsu)|(Motorola)|(SHARP)|(WAPPER)|(LG-)|(LG/)|(EG900)|(CECT)|(Compal)|(kejian)|(Bird)|(BIRD)|(G900/V1.0)|(Arima)|(CTL)|(TDG)|(Daxian)|(DAXIAN)|(DBTEL)|(Eastcom)|(EASTCOM)|(PANTECH)|(Dopod)|(Haier)|(HAIER)|(KONKA)|(KEJIAN)|(LENOVO)|(Soutec)|(SOUTEC)|(SAGEM)|(SEC-)|(SED-)|(EMOL-)|(INNO55)|(ZTE)|(iPhone)|(Android)|(Windows CE)|(Wget)|(Java)|(curl)|(Opera)"',domain:""})}}},u=l,p=s("c701"),d=Object(p["a"])(u,o,c,!1,null,null,null),v=d.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:t.basicAuthSwitch}},[t._v("\n                开启BasicAuth:\n                "),s("i",{staticClass:"fa",class:t.isBasicAuth?"fa-check-circle text-success":"fa-square-o"})])]),t.isBasicAuth?[t._m(0),s("select",{directives:[{name:"model",rawName:"v-model",value:t.data.authBasic.userFile,expression:"data.authBasic.userFile"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.data.authBasic,"userFile",e.target.multiple?s:s[0])}}},t._l(t.authFiles,(function(e){return s("option",{domProps:{value:e.name}},[t._v(t._s(e.name))])})),0)]:t._e()],2)])},f=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("认证文件")])])}],h={name:"BasicAuth",model:{prop:"data",event:"change"},props:["data"],data:function(){return{authFiles:[]}},mounted:function(){this.queryBasicAuthFile()},computed:{isBasicAuth:function(){return!!this.data.authBasic&&"on"===this.data.authBasic.switch}},methods:{queryBasicAuthFile:function(){var t=this;t.$axios.get("/admin/api/file/search?q="+encodeURI("auths/*")).then((function(e){t.authFiles=e})).catch((function(e){t.$alert("查询失败："+e.message)}))},basicAuthSwitch:function(){this.isBasicAuth?this.$delete(this.data,"authBasic"):this.$set(this.data,"authBasic",{switch:"on",userFile:""})}}},b=h,C=Object(p["a"])(b,m,f,!1,null,"678915ec",null),g=C.exports,_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.ssl?s("div",{staticClass:"card card-accent-primary"},[s("div",{staticClass:"card-header"},[t._v("\n        SSL信息\n    ")]),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("button",{staticClass:"btn btn-default",on:{click:function(e){t.server.ssl.httpRedirect=!t.server.ssl.httpRedirect}}},[t._v("\n                    HTTP 301跳转HTTPS:\n                    "),s("i",{staticClass:"fa",class:t.server.ssl.httpRedirect?"fa-check-circle text-success":"fa-square-o"})])]),s("div",{staticClass:"col-auto"},[s("SSLProtocols",{model:{value:t.server.ssl.protocols,callback:function(e){t.$set(t.server.ssl,"protocols",e)},expression:"server.ssl.protocols"}})],1)]),s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"input-group"},[t._m(0),s("input",{directives:[{name:"model",rawName:"v-model",value:this.server.ssl.certificate,expression:"this.server.ssl.certificate"}],staticClass:"form-control",attrs:{placeholder:"证书文件（PEM）",type:"text",readonly:"readonly"},domProps:{value:this.server.ssl.certificate},on:{input:function(e){e.target.composing||t.$set(this.server.ssl,"certificate",e.target.value)}}}),t._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:this.server.ssl.certificateKey,expression:"this.server.ssl.certificateKey"}],staticClass:"form-control",attrs:{placeholder:"证书文件（key）",type:"text",readonly:"readonly"},domProps:{value:this.server.ssl.certificateKey},on:{input:function(e){e.target.composing||t.$set(this.server.ssl,"certificateKey",e.target.value)}}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-css3",on:{click:t.queryCerts}},[s("i",{staticClass:"fa fa-folder-open"}),t._v(" 选择\n                    ")])])])]),s("Modal",{attrs:{show:null!==t.certs,title:"选择证书"},on:{ok:function(e){t.certs=null},cancel:function(e){t.certs=null}}},[s("div",{staticClass:"overflow-auto",staticStyle:{"max-height":"400px"}},[s("table",{staticClass:"table table-hover table-bordered mb-0"},[s("thead",[s("tr",[s("th",[t._v("域名")]),s("th",[t._v("过期时间")]),s("th",[t._v("操作")])])]),s("tbody",t._l(t.certs,(function(e,a){return s("tr",[s("td",[t._v(t._s(e.domain))]),s("td",[t._v(t._s(t.expireTime(e.expireTime)))]),s("td",[s("button",{staticClass:"btn btn-sm btn-outline-dark",on:{click:function(s){return t.useCert(e)}}},[t._v("选择\n                            ")])])])})),0)])])])],1)]):t._e()},x=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("证书文件(crt)：")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("私钥文件(key)：")])])}],y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group"},[s("div",{staticClass:"input-group"},[t._m(0),t._l(t.protocols,(function(e){return s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-default",on:{click:function(s){return t.setSupport(e)}}},[s("i",{staticClass:"fa",class:t.isSupport(e)?"fa-check-circle text-success":"fa-square-o"}),t._v("\n                "+t._s(e)+"\n            ")])])}))],2)])},w=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("HTTPS支持协议")])])}],k=(s("9a33"),{name:"SSLProtocols",data:function(){return{protocols:["SSLv2","SSLv3","TLSv1","TLSv1.1","TLSv1.2","TLSv1.3"]}},model:{prop:"value",event:"change"},props:["value"],computed:{supports:function(){return this.value.split(" ")}},methods:{isSupport:function(t){for(var e=0;e<this.supports.length;e++)if(this.supports[e]===t)return!0;return!1},setSupport:function(t){if(this.isSupport(t)){for(var e="",s=0;s<this.supports.length;s++)t!==this.supports[s]&&(e+=this.supports[s]+" ");this.value=e.trim()}else this.value=this.value+(""===this.value.trim()?"":" ")+t;this.$emit("change",this.value)}}}),S=k,$=Object(p["a"])(S,y,w,!1,null,null,null),P=$.exports,O=s("5df5"),E={name:"ServerSSL",components:{Modal:O["a"],SSLProtocols:P},model:{prop:"server",event:"change"},props:["server"],data:function(){return{certs:null}},computed:{ssl:function(){if(this.server.listens)for(var t=0;t<this.server.listens.length;t++)if(this.server.listens[t].ssl)return!0;return!1}},watch:{ssl:function(t,e){t?this.$set(this.server,"ssl",{httpRedirect:!1,protocols:"TLSv1 TLSv1.1 TLSv1.2",certificate:"",certificateKey:""}):this.$delete(this.server,"ssl")}},methods:{expireTime:function(t){return t.substr(0,10)+" "+t.substr(11,8)},queryCerts:function(){var t=this;t.$axios.get("/admin/api/cert/list").then((function(e){t.certs=e})).catch((function(e){t.$alert("查询证书异常："+e.message)}))},useCert:function(t){this.server.ssl.certificate=t.certificate,this.server.ssl.certificateKey=t.privateKey,this.certs=null}}},B=E,L=Object(p["a"])(B,_,x,!1,null,"41d1d79f",null),A=L.exports,q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group form-inline"},[s("div",{staticClass:"input-group"},[t._m(0),t._l(t.server.listens,(function(e,a){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.listens[a].host,expression:"server.listens[idx].host"}],staticClass:"form-control",attrs:{type:"text",placeholder:"IP地址"},domProps:{value:t.server.listens[a].host},on:{input:function(e){e.target.composing||t.$set(t.server.listens[a],"host",e.target.value)}}}),s("input",{staticClass:"form-control",attrs:{type:"number",placeholder:"PORT"},domProps:{value:t.server.listens[a].port},on:{change:function(e){t.server.listens[a].port=Number(e.target.value)}}}),"http"===t.server.protocol?[s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(t){e.default=!e.default}}},[s("i",{staticClass:"fa",class:e.default?"fa-check-square text-success":"fa-square-o"}),t._v("\n                        默认\n                    ")])]),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(t){e.http2=!e.http2}}},[s("i",{staticClass:"fa",class:e.http2?"fa-check-square text-success":"fa-square-o"}),t._v("\n                        HTTP2\n                    ")])]),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(t){e.ssl=!e.ssl}}},[s("i",{staticClass:"fa",class:e.ssl?"fa-check-square text-success":"fa-square-o"}),t._v("\n                        SSL\n                    ")])])]:t._e(),t.server.listens.length>1?s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.server.listens.splice(a,1)}}},[s("i",{staticClass:"fa fa-trash"})])]):t._e()]})),s("div",{staticClass:"input-group-append",on:{click:function(e){return t.server.listens.push({host:"",port:8080,default:!1,http2:!1,ssl:!1})}}},[t._m(1)])],2)])},N=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("监听地址")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"btn btn-css3"},[s("i",{staticClass:"fa fa-plus"})])}],j={name:"ServerListens",model:{prop:"server",event:"change"},props:["server"]},M=j,T=Object(p["a"])(M,q,N,!1,null,null,null),I=T.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-group form-inline"},[s("div",{staticClass:"input-group"},[t._m(0),t._l(t.server.domains,(function(e,a){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.domains[a],expression:"server.domains[idx]"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.server.domains[a]},on:{input:function(e){e.target.composing||t.$set(t.server.domains,a,e.target.value)}}}),t.server.domains.length>1?s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.server.domains.splice(a,1)}}},[s("i",{staticClass:"fa fa-trash"})])]):t._e()]})),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-css3",on:{click:function(e){return t.server.domains.push("")}}},[s("i",{staticClass:"fa fa-plus"})])])],2)])},z=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("域名")])])}],H={name:"ServerName",model:{prop:"server",event:"change"},props:["server"]},R=H,K=Object(p["a"])(R,D,z,!1,null,"3c52528c",null),U=K.exports,F=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-inline"},[s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"input-group"},[t._m(0),t._l(t.data.allows,(function(e,a){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.data.allows[a],expression:"data.allows[idx]"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.allows[a]},on:{input:function(e){e.target.composing||t.$set(t.data.allows,a,e.target.value)}}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.data.allows.splice(a,1)}}},[s("i",{staticClass:"fa fa-trash"})])])]})),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-css3",on:{click:function(e){return t.appendOne("allows",t.localIP)}}},[s("i",{staticClass:"fa fa-plus"})])]),t._m(1),t._l(t.data.denys,(function(e,a){return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.data.denys[a],expression:"data.denys[idx]"}],staticClass:"form-control",attrs:{width:"120px",type:"text"},domProps:{value:t.data.denys[a]},on:{input:function(e){e.target.composing||t.$set(t.data.denys,a,e.target.value)}}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.data.denys.splice(a,1)}}},[s("i",{staticClass:"fa fa-trash"})])])]})),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-css3",on:{click:function(e){return t.appendOne("denys","all")}}},[s("i",{staticClass:"fa fa-plus"})])])],2)])])},W=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("Allow")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("Deny")])])}],G={name:"AllowDeny",model:{prop:"data",event:"change"},props:["data"],data:function(){return{localIP:""}},mounted:function(){this.queryLocal()},methods:{queryLocal:function(){},appendOne:function(t,e){void 0!==this.data[t]&&null!==this.data[t]||this.$set(this.data,t,[]),this.data[t].push(e)}}},J=G,V=Object(p["a"])(J,F,W,!1,null,null,null),Q=V.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return"http"===t.server.protocol?s("div",{staticClass:"card card-accent-primary"},[s("div",{staticClass:"card-header"},[t._v("\n        代理地址(location)\n        "),s("div",{staticClass:"card-header-actions"},[s("div",{staticClass:"card-header-action btn-minimize text-dark",on:{click:t.addLocation}},[s("i",{staticClass:"fa fa-plus"}),t._v("\n                添加代理路径\n            ")])])]),s("table",{staticClass:"table table-hover mb-0"},[t._m(0),t._l(t.server.locations,(function(e,a){return"http"===t.server.protocol?[s("tr",[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].path,expression:"server.locations[idx].path"}],staticClass:"form-control",class:{"is-invalid":""===t.server.locations[a].path},attrs:{placeholder:"路径",type:"text"},domProps:{value:t.server.locations[a].path},on:{input:function(e){e.target.composing||t.$set(t.server.locations[a],"path",e.target.value)}}})]),s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].type,expression:"server.locations[idx].type"}],staticClass:"form-control",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.server.locations[a],"type",e.target.multiple?s:s[0])},function(e){return t.changeType(a)}]}},[s("option",{attrs:{value:"html"}},[t._v("静态文件")]),s("option",{attrs:{value:"upstream"}},[t._v("负载均衡")]),s("option",{attrs:{value:"http"}},[t._v("动态代理")]),s("option",{attrs:{value:"custom",selected:""}},[t._v("用户定义")])])]),s("td",["html"===t.server.locations[a].type?[s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-group-prepend"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].html.model,expression:"server.locations[idx].html.model"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.server.locations[a].html,"model",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"root",selected:""}},[t._v("ROOT模式")]),s("option",{attrs:{value:"alias"}},[t._v("Alias模式")])])]),t._m(1,!0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].html.path,expression:"server.locations[idx].html.path"}],staticClass:"form-control",class:{"is-invalid":""===t.server.locations[a].html.path},attrs:{placeholder:"路径",type:"text"},domProps:{value:t.server.locations[a].html.path},on:{input:function(e){e.target.composing||t.$set(t.server.locations[a].html,"path",e.target.value)}}}),t._m(2,!0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].html.indexes,expression:"server.locations[idx].html.indexes"}],staticClass:"form-control",class:{"is-invalid":""===t.server.locations[a].html.indexes},attrs:{placeholder:"主页",type:"text"},domProps:{value:t.server.locations[a].html.indexes},on:{input:function(e){e.target.composing||t.$set(t.server.locations[a].html,"indexes",e.target.value)}}})])])]:"upstream"===t.server.locations[a].type?[s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"input-group"},[t._m(3,!0),s("div",{staticClass:"input-group-append"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].upstream.name,expression:"server.locations[idx].upstream.name"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.server.locations[a].upstream,"name",e.target.multiple?s:s[0])}}},t._l(t.upstreams,(function(e){return"http"===e.protocol?s("option",{domProps:{value:e.name}},[""!==e.commit?[t._v("\n                                                "+t._s(e.commit)+" ("+t._s(e.name)+")\n                                            ")]:[t._v("\n                                                "+t._s(e.name)+"\n                                            ")]],2):t._e()})),0)]),t._m(4,!0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].upstream.path,expression:"server.locations[idx].upstream.path"}],staticClass:"form-control",attrs:{placeholder:"额外地址",type:"text"},domProps:{value:t.server.locations[a].upstream.path},on:{input:function(e){e.target.composing||t.$set(t.server.locations[a].upstream,"path",e.target.value)}}}),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(e){t.server.locations[a].basicHeader=!t.server.locations[a].basicHeader}}},[s("i",{staticClass:"fa",class:t.server.locations[a].basicHeader?"fa-check-square text-success":"fa-square-o"}),t._v("\n                                        基础header\n                                    ")])]),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(e){t.server.locations[a].webSocket=!t.server.locations[a].webSocket}}},[s("i",{staticClass:"fa",class:t.server.locations[a].webSocket?"fa-check-square text-success":"fa-square-o"}),t._v("\n                                        WebSocket\n                                    ")])])])])]:"http"===t.server.locations[a].type?[s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"input-group"},[t._m(5,!0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.server.locations[a].http.to,expression:"server.locations[idx].http.to"}],staticClass:"form-control",class:{"is-invalid":""===t.server.locations[a].http.to},attrs:{placeholder:"代理地址",type:"text"},domProps:{value:t.server.locations[a].http.to},on:{input:function(e){e.target.composing||t.$set(t.server.locations[a].http,"to",e.target.value)}}}),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(e){t.server.locations[a].basicHeader=!t.server.locations[a].basicHeader}}},[s("i",{staticClass:"fa",class:t.server.locations[a].basicHeader?"fa-check-square text-success":"fa-square-o"}),t._v("\n                                        基础header\n                                    ")])]),s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-default",on:{click:function(e){t.server.locations[a].webSocket=!t.server.locations[a].webSocket}}},[s("i",{staticClass:"fa",class:t.server.locations[a].webSocket?"fa-check-square text-success":"fa-square-o"}),t._v("\n                                        WebSocket\n                                    ")])])])])]:[s("Partamters",{attrs:{prompt:"location"},model:{value:t.server.locations[a].parameters,callback:function(e){t.$set(t.server.locations[a],"parameters",e)},expression:"server.locations[idx].parameters"}})]],2),s("td",{staticClass:"d-flex justify-content-around"},["custom"!==t.server.locations[a].type?s("button",{staticClass:"btn btn-sm btn-css3",attrs:{title:"额外参数"},on:{click:function(e){return t.showParamIdx(a)}}},[s("i",{staticClass:"fa fa-align-justify"})]):t._e(),s("button",{staticClass:"btn btn-sm btn-success",attrs:{disabled:0===a,title:"上移动"},on:{click:function(e){return t.moveUp(a)}}},[s("i",{staticClass:"fa fa-arrow-up"})]),s("button",{staticClass:"btn btn-sm btn-danger",attrs:{title:"删除"},on:{click:function(e){return t.delLoc(a)}}},[s("i",{staticClass:"fa fa-trash"})])])]),t.showParams===a&&"custom"!==t.server.locations[a].type?s("tr",[s("td",{staticClass:"p-3",attrs:{colspan:"4"}},[s("Partamters",{attrs:{prompt:"location"},model:{value:t.server.locations[a].parameters,callback:function(e){t.$set(t.server.locations[a],"parameters",e)},expression:"server.locations[idx].parameters"}}),s("hr"),s("BasicAuth",{staticClass:"mt-2",model:{value:t.server.locations[a],callback:function(e){t.$set(t.server.locations,a,e)},expression:"server.locations[idx]"}}),s("AllowDeny",{model:{value:t.server.locations[a],callback:function(e){t.$set(t.server.locations,a,e)},expression:"server.locations[idx]"}})],1)]):t._e()]:t._e()}))],2)]):s("div",{staticClass:"form-group"},[s("div",{staticClass:"input-group"},[t._m(6),s("select",{directives:[{name:"model",rawName:"v-model",value:t.server.proxyPass,expression:"server.proxyPass"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.server,"proxyPass",e.target.multiple?s:s[0])}}},t._l(t.upstreams,(function(e){return"tcp"===e.protocol?s("option",{domProps:{value:e.name}},[""!==e.commit?[t._v("\n                    "+t._s(e.commit)+" ("+t._s(e.name)+")\n                ")]:[t._v("\n                    "+t._s(e.name)+"\n                ")]],2):t._e()})),0)])])},Z=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",{staticStyle:{width:"160px"}},[t._v("路径")]),s("th",{staticStyle:{width:"120px"}},[t._v("类型")]),s("th",[t._v("目标")]),s("th",{attrs:{width:"140px"}},[t._v("操作")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-append"},[s("span",{staticClass:"input-group-text"},[t._v("路径")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-append"},[s("span",{staticClass:"input-group-text"},[t._v("主页")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("负载")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("span",{staticClass:"input-group-text"},[t._v("额外地址")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("div",{staticClass:"input-group-text"},[t._v("\n                                        代理地址：\n                                    ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-dark "},[t._v("\n                转向负载：\n            ")])])}],Y=s("75f7"),tt={name:"ServerLocations",components:{BasicAuth:g,AllowDeny:Q,Partamters:Y["a"]},model:{prop:"server",event:"change"},props:["server"],data:function(){return{upstreams:[{name:"未找到负载"}],showParams:null}},created:function(){this.queryUpstreams()},methods:{queryUpstreams:function(){var t=this;t.$axios.get("/admin/api/upstream").then((function(e){t.upstreams=e})).catch((function(e){t.$toast.error("获取负载均衡错误"+e.message)}))},changeType:function(t){var e=this.server.locations[t];this.$delete(e,"upstream"),this.$delete(e,"http"),this.$delete(e,"html"),"upstream"===e.type?this.$set(e,"upstream",{name:"",path:""}):"html"===e.type?this.$set(e,"html",{path:"",model:"root",indexes:"index.html index.htm"}):"http"===e.type&&this.$set(e,"http",{to:""})},addLocation:function(){this.server.locations.push({path:"",type:"http",http:{to:""},parameters:[]})},moveUp:function(t){this.server.locations[t]=this.server.locations.splice(t-1,1,this.server.locations[t])[0]},delLoc:function(t){this.server.locations.splice(t,1)},showParamIdx:function(t){this.showParams===t?this.showParams=null:this.showParams=t}}},et=tt,st=Object(p["a"])(et,X,Z,!1,null,null,null),at=st.exports,rt=s("fc76"),nt={name:"ServerEdit",components:{Partamters:Y["a"],HideCard:rt["a"],ServerLocations:at,AllowDeny:Q,ServerName:U,ServerListens:I,ServerSSL:A,BasicAuth:g,RewriteMobile:v,VTitle:n["a"],codemirror:i["codemirror"]},data:function(){return{server:{},cmOptions:{tabSize:4,theme:"lesser-dark",mode:"json",line:!0,lineWrapping:!0,lineNumbers:!0,collapseIdentical:!1,highlightDifferences:!0}}},mounted:function(){this.$route.query.name?this.getServer():this.setServerProtocol("http")},computed:{serverString:function(){return JSON.stringify(this.server,null,"\t")}},methods:{setServerProtocol:function(t){"http"===t?this.server={queries:[],commit:"",protocol:"http",listens:[{port:80,default:!1,http2:!1,ssl:!1}],domains:[""],locations:[{path:"/",type:"http",http:{to:""},basicHeader:!0,webSocket:!1,parameters:[]}],parameters:[]}:void 0===this.$route.query.name&&(this.server={queries:[],commit:"",protocol:t,listens:[{port:8080}],proxyPass:"",parameters:[]})},getServer:function(){var t=this,e="/admin/api/server?name="+t.$route.query.name+"&protocol="+t.$route.query.protocol;t.$axios.get(e).then((function(e){t.server=e[0]})).catch((function(e){t.$alert(e.message)}))},modfiyServer:function(){var t=this;t.$axios.post("/admin/api/server",this.server).then((function(e){t.$toast.success("更新成功！"),t.$router.push({path:"/admin/servers"})})).catch((function(e){t.$alert(e.message)}))}}},it=nt,ot=(s("6d20"),Object(p["a"])(it,a,r,!1,null,null,null));e["default"]=ot.exports},ebc3:function(t,e,s){"use strict";var a=s("064e"),r=s("cc33");t.exports=function(t,e,s){e in t?a.f(t,e,r(0,s)):t[e]=s}},f0cc:function(t,e,s){var a=s("e46b"),r=s("7ddc"),n=s("238a");t.exports=function(t,e){var s=(r.Object||{})[t]||Object[t],i={};i[t]=e(s),a(a.S+a.F*n((function(){s(1)})),"Object",i)}}}]);
//# sourceMappingURL=chunk-6e74cea2.c8a114bc.js.map