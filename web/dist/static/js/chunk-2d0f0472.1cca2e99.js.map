{"version":3,"sources":["webpack:///./src/views/files/Files.vue?0231","webpack:///src/views/files/Files.vue","webpack:///./src/views/files/Files.vue?e8ae","webpack:///./src/views/files/Files.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","_l","p","idx","path","query","getPath","_s","_m","directives","name","rawName","value","expression","domProps","on","$event","target","composing","search","queryFiles","$router","push","folder","item","f","staticRenderFns","component"],"mappings":"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","file":"static/js/chunk-2d0f0472.1cca2e99.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ol',{staticClass:\"breadcrumb\"},[_c('li',{staticClass:\"breadcrumb-fixed\"},[_c('router-link',{staticClass:\"text-primary font-weight-bold\",attrs:{\"to\":\"/admin/files\"}},[_c('i',{staticClass:\"fa fa-home\"}),_vm._v(\"文件目录：\\n            \")])],1),_vm._l((_vm.paths),function(p,idx){return _c('li',{staticClass:\"breadcrumb-fixed text-primary font-weight-bold\"},[_c('router-link',{attrs:{\"to\":{path:'/admin/files',query:{path:_vm.getPath(idx)}}}},[_vm._v(_vm._s(p)+\"/\")])],1)})],2),_c('div',{staticClass:\"animated fadeIn pl-3 pr-3 pt-3 row\"},[_c('div',{staticClass:\"form-group col-12\"},[_c('div',{staticClass:\"input-group\"},[_vm._m(0),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.search),expression:\"search\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"name\":\"program\",\"placeholder\":\"匹配内容：*、*.conf、hosts.d/*.conf\"},domProps:{\"value\":(_vm.search)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.search=$event.target.value}}}),_c('div',{staticClass:\"input-group-append\"},[_c('button',{staticClass:\"btn btn-sm btn-css3\",on:{\"click\":_vm.queryFiles}},[_c('i',{staticClass:\"fa fa-search\"}),_vm._v(\"  搜  索  \\n                    \")]),_c('button',{staticClass:\"btn btn-sm btn-primary text-white font-weight-bold\",on:{\"click\":function($event){return _vm.$router.push({path:'/admin/file/edit',query:{path:_vm.folder}})}}},[_c('i',{staticClass:\"fa fa-file-text\"}),_vm._v(\" 新建文件 \\n                    \")])])])])]),_c('div',{staticClass:\"pl-4 pr-4\"},[(_vm.search === '')?_c('div',[_c('div',{staticClass:\"row\"},_vm._l((_vm.showFiles),function(item){return _c('div',{staticClass:\"col-auto\"},[(item.folder)?_c('div',{staticClass:\"brand-card-body\"},[_c('router-link',{staticClass:\"p-1\",attrs:{\"to\":{path:'/admin/files', query:{path:item.path} }}},[_c('i',{staticClass:\"fa fa-2x text-warning fa-folder\"}),_c('div',{staticClass:\"text-wrap\"},[_vm._v(_vm._s(item.name))])])],1):_c('div',{staticClass:\"brand-card-body\"},[_c('router-link',{staticClass:\"p-1\",attrs:{\"to\":{path:'/admin/file/edit',query:{name:item.path}}}},[_c('i',{staticClass:\"fa fa-2x text-info fa-file\"}),_c('div',{staticClass:\"text-wrap\"},[_vm._v(_vm._s(item.name))])])],1)])}),0)]):_c('div',{staticClass:\" pt-1\"},[_c('div',{staticClass:\"list-group\"},_vm._l((_vm.files),function(f,idx){return _c('a',{staticClass:\"list-group-item list-group-item-action\"},[_c('i',{staticClass:\"fa text-warning text-info fa-file\"}),_vm._v(\" \"+_vm._s(f.name)+\"\\n                \")])}),0)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"input-group-prepend\"},[_c('span',{staticClass:\"input-group-text bg-css3 text-white\"},[_vm._v(\"文件查找\")])])}]\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <ol class=\"breadcrumb\">\n            <li class=\"breadcrumb-fixed\">\n                <router-link class=\"text-primary font-weight-bold\" to=\"/admin/files\"><i class=\"fa fa-home\"/>文件目录：\n                </router-link>\n            </li>\n            <li v-for=\"(p,idx) in paths\" class=\"breadcrumb-fixed text-primary font-weight-bold\">\n                <router-link :to=\"{path:'/admin/files',query:{path:getPath(idx)}}\">{{ p }}/</router-link>\n            </li>\n        </ol>\n\n        <div class=\"animated fadeIn pl-3 pr-3 pt-3 row\">\n            <div class=\"form-group col-12\">\n                <div class=\"input-group\">\n                    <div class=\"input-group-prepend\">\n                        <span class=\"input-group-text bg-css3 text-white\">文件查找</span>\n                    </div>\n                    <input type=\"text\" name=\"program\" v-model=\"search\" placeholder=\"匹配内容：*、*.conf、hosts.d/*.conf\"\n                           class=\"form-control\"/>\n                    <div class=\"input-group-append\">\n                        <button class=\"btn btn-sm btn-css3\" @click=\"queryFiles\">\n                            <i class=\"fa fa-search\"></i>&nbsp;&nbsp;搜&nbsp;&nbsp;索&nbsp;&nbsp;\n                        </button>\n                        <button class=\"btn btn-sm btn-primary text-white font-weight-bold\"\n                                @click=\"$router.push({path:'/admin/file/edit',query:{path:folder}})\">\n                            <i class=\"fa fa-file-text\"></i>&nbsp;新建文件&nbsp;\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"pl-4 pr-4\">\n            <div v-if=\"search === ''\">\n                <!--<div class=\"row\">\n                    <div v-if=\"paths.length > 0\" class=\"col-auto\">\n                        <div class=\"brand-card-body\">\n                            <router-link class=\"text-dark\" to=\"/admin/files\">\n                                <i class=\"fa fa-2x text-dark fa-home\"/>\n                                <div class=\"text-wrap\">根目录</div>\n                            </router-link>\n                        </div>\n                    </div>\n\n                    <div v-if=\"paths.length > 1\" class=\"col-auto\">\n                        <div class=\"brand-card-body\">\n                            <router-link class=\"text-dark\"\n                                         :to=\"{path:'/admin/files',query:{path:getPath(paths.length-2)}}\">\n                                <i class=\"fa fa-2x text-dark fa-folder-open\"/>\n                                <div class=\"text-wrap\">上一级</div>\n                            </router-link>\n                        </div>\n                    </div>\n                </div>-->\n                <div class=\"row\">\n                    <div class=\"col-auto\" v-for=\"item in showFiles\">\n                        <div v-if=\"item.folder\" class=\"brand-card-body\">\n                            <router-link :to=\"{path:'/admin/files', query:{path:item.path} }\" class=\"p-1\">\n                                <i class=\"fa fa-2x text-warning fa-folder\"/>\n                                <div class=\"text-wrap\">{{ item.name }}</div>\n                            </router-link>\n                        </div>\n                        <div v-else class=\"brand-card-body\">\n                            <router-link :to=\"{path:'/admin/file/edit',query:{name:item.path}}\"\n                                         class=\"p-1\">\n                                <i class=\"fa fa-2x text-info fa-file\"/>\n                                <div class=\"text-wrap\">{{ item.name }}</div>\n                            </router-link>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div v-else class=\" pt-1\">\n                <div class=\"list-group\">\n                    <a v-for=\"(f,idx) in files\" class=\"list-group-item list-group-item-action\">\n                        <i class=\"fa text-warning text-info fa-file\"/> {{ f.name }}\n                    </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport VTitle from \"../../plugins/vTitle\";\nimport Delete from \"../../plugins/delete\";\nimport Modal from \"../../plugins/modal\";\nimport {codemirror} from 'vue-codemirror'\nimport 'codemirror/mode/nginx/nginx.js'\nimport 'codemirror/lib/codemirror.css'\nimport 'codemirror/theme/lesser-dark.css'\n\nexport default {\n    name: \"Files\",\n    components: {Modal, Delete, VTitle, codemirror},\n    data: () => ({\n        files: [], search: \"\"\n    }),\n    mounted() {\n        this.queryFiles();\n    },\n    computed: {\n        folder() {\n            let folder = this.$route.query[\"path\"]\n            if (folder === undefined) {\n                folder = \"\"\n            }\n            return folder;\n        },\n        paths() {\n            let folder = this.folder;\n            if (folder !== \"\") {\n                return folder.split(\"/\")\n            } else {\n                return [];\n            }\n        },\n        showFiles() {\n            let folder = this.folder;\n\n            let folders = {};\n            let shows = [];\n            for (let idx in this.files) {\n                let f = this.getFile(this.files[idx])\n                if (f.dir === folder) {\n                    shows.push(f)\n                }\n                if (f.dir !== \"\") {\n                    let fd = this.getFolder(f.dir, folder)\n                    if (fd !== undefined && folders[fd.name] === undefined) {\n                        shows.unshift(fd)\n                        folders[fd.name] = fd\n                    }\n                }\n            }\n            return shows\n        }\n    },\n    methods: {\n        refresh() {\n            this.queryFiles();\n        },\n        queryFiles() {\n            this.startLoading();\n            let self = this;\n            let url = \"/admin/api/file/search\"\n            if (this.search !== \"\") {\n                url += \"?q=\" + encodeURI(this.search);\n            }\n            self.$axios.get(url).then(res => {\n                self.files = res;\n            }).catch(e => {\n                self.$toast.error(e.message);\n            }).finally(() => {\n                self.finishLoading();\n            });\n        },\n        getFile(file) {\n            let filePaths = file.name.split(\"/\")\n            return {\n                name: filePaths.pop(), dir: filePaths.join(\"/\"),\n                path: file.name, folder: false\n            }\n        },\n        getFolder(file, folder) {\n            if (folder === \"\") {\n                let name = file.split(\"/\").shift()\n                return {\n                    name: name, path: name, folder: true,\n                }\n            } else if (file.indexOf(folder + \"/\") === 0 && file !== folder) {\n                let name = file.replace(folder + \"/\", \"\").split(\"/\").shift();\n                return {\n                    name: name, path: folder + \"/\" + name, folder: true,\n                }\n            }\n            return undefined\n        },\n        getPath(idx) {\n            return this.paths.slice(0, idx + 1).join(\"/\")\n        },\n    }\n}\n</script>\n","import mod from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Files.vue?vue&type=template&id=9189c1a2&\"\nimport script from \"./Files.vue?vue&type=script&lang=js&\"\nexport * from \"./Files.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}